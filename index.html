<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç”Ÿå­˜æŒ‡å—å°æˆ°</title>

  <!-- åƒç´ å­—é«”ï¼šæ›´åƒ Game Boyï¼ˆå¯ç•™å¯ä¸ç•™ï¼‰ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      --gb0:#0b1f17;   /* æœ€æ·± */
      --gb1:#183a2c;
      --gb2:#5fa65f;
      --gb3:#d8f7c8;   /* æœ€äº® */
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(#08150f, #06110c);
      color:var(--gb0);
      display:flex;
      justify-content:center;
      font-family:"Press Start 2P", ui-monospace, Menlo, Monaco, Consolas, monospace;
    }
    .wrap{width:min(880px, 100%); padding:14px;}
    .screen{
      background:var(--gb3);
      border:6px solid var(--gb0);
      box-shadow: 0 0 0 6px var(--gb2), 10px 10px 0 rgba(0,0,0,.35);
      padding:12px;
    }

    /* åƒç´ åŒ–é‚Šæ¡†æ„Ÿ */
    .box{
      border:4px solid var(--gb0);
      background:var(--gb3);
      padding:10px;
    }

    .battle{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      align-items:stretch;
    }

    .spriteBox{
      height:180px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        linear-gradient(transparent 15px, rgba(0,0,0,.08) 16px),
        linear-gradient(90deg, transparent 15px, rgba(0,0,0,.08) 16px);
      background-size:16px 16px;
      border:4px solid var(--gb0);
    }

    /* ç”¨ç´” CSS åšå…©å€‹ã€Œåƒç´ è§’è‰²ã€(ä¸é åœ–ç‰‡ä¹Ÿå¾ˆåƒ) */
    .sprite{
      width:96px; height:96px;
      image-rendering: pixelated;
      background:var(--gb1);
      box-shadow:
        16px 16px 0 var(--gb1),
        32px 16px 0 var(--gb1),
        48px 16px 0 var(--gb1),
        16px 32px 0 var(--gb1),
        32px 32px 0 var(--gb2),
        48px 32px 0 var(--gb1),
        16px 48px 0 var(--gb1),
        32px 48px 0 var(--gb1),
        48px 48px 0 var(--gb1);
      transform:scale(1.8);
    }
    .sprite.opponent{
      transform:scale(1.6) rotate(0deg);
      box-shadow:
        16px 16px 0 var(--gb1),
        32px 16px 0 var(--gb1),
        48px 16px 0 var(--gb1),
        64px 16px 0 var(--gb1),
        16px 32px 0 var(--gb1),
        32px 32px 0 var(--gb2),
        48px 32px 0 var(--gb2),
        64px 32px 0 var(--gb1),
        16px 48px 0 var(--gb1),
        32px 48px 0 var(--gb1),
        48px 48px 0 var(--gb1),
        64px 48px 0 var(--gb1);
    }

    .status{
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .nameRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      font-size:12px;
      color:var(--gb0);
    }
    .lvl{opacity:.9}

    .hpRow{
      display:flex;
      align-items:center;
      gap:8px;
      font-size:10px;
    }
    .hpBar{
      position:relative;
      width:100%;
      height:14px;
      border:3px solid var(--gb0);
      background:var(--gb3);
    }
    .hpFill{
      height:100%;
      width:100%;
      background:var(--gb2);
      transition: width .25s linear;
    }
    .hpNum{min-width:88px; text-align:right;}

    .bottom{
      margin-top:10px;
      display:grid;
      grid-template-columns: 1.4fr .6fr;
      gap:10px;
    }

    .dialog{
      height:150px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
    }
    .text{
      font-size:12px;
      line-height:1.8;
      min-height:70px;
      white-space:pre-wrap;
    }
    .hint{
      font-size:10px;
      opacity:.9;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .caret{font-size:14px}

    .menu{
      height:150px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .menuGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:8px;
      height:100%;
    }
    .btn{
      border:4px solid var(--gb0);
      background:var(--gb3);
      font-family:inherit;
      font-size:11px;
      padding:10px 8px;
      cursor:pointer;
      position:relative;
      text-align:left;
    }
    .btn:hover{background:#c9f2b5}
    .btn:disabled{opacity:.55; cursor:not-allowed}
    .btn.sel::before{
      content:"â–¶";
      position:absolute;
      left:6px;
    }
    .btn span{margin-left:18px; display:inline-block}

    .topTitle{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:10px;
      font-size:12px;
      color:var(--gb3);
    }
    .badge{
      border:3px solid var(--gb3);
      padding:8px 10px;
    }

    a.linkBtn{
      display:inline-block;
      border:4px solid var(--gb0);
      background:var(--gb2);
      color:var(--gb0);
      text-decoration:none;
      padding:10px 12px;
      font-size:11px;
    }
    a.linkBtn:hover{filter:brightness(1.05)}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topTitle">
      <div class="badge">ğŸ® ç”Ÿå­˜æŒ‡å—å°æˆ°</div>
      <div class="badge">æŒ‰éˆ•æ“ä½œï¼šé»é¸å³å´é¸å–®</div>
    </div>

    <div class="screen">
      <div class="battle">
        <!-- å·¦ä¸Šï¼šå°æ‰‹ç‹€æ…‹ -->
        <div class="status box">
          <div class="nameRow">
            <div id="oppName">å°æ‰‹</div>
            <div class="lvl">Lv <span id="oppLv">12</span></div>
          </div>
          <div class="hpRow">
            <div>HP</div>
            <div class="hpBar"><div class="hpFill" id="oppHpFill"></div></div>
          </div>
          <div class="hpNum"><span id="oppHpText">20</span>/20</div>
        </div>

        <!-- å³ä¸Šï¼šå°æ‰‹ sprite -->
        <div class="spriteBox">
          <div class="sprite opponent" aria-label="opponent"></div>
        </div>

        <!-- å·¦ä¸‹ï¼šè‡ªå·± sprite -->
        <div class="spriteBox">
          <div class="sprite" aria-label="player"></div>
        </div>

        <!-- å³ä¸‹ï¼šè‡ªå·±ç‹€æ…‹ -->
        <div class="status box">
          <div class="nameRow">
            <div id="meName">ä½ </div>
            <div class="lvl">Lv <span id="meLv">12</span></div>
          </div>
          <div class="hpRow">
            <div>HP</div>
            <div class="hpBar"><div class="hpFill" id="meHpFill"></div></div>
          </div>
          <div class="hpNum"><span id="meHpText">20</span>/20</div>
        </div>
      </div>

      <div class="bottom">
        <!-- å°è©±æ¡† -->
        <div class="dialog box">
          <div class="text" id="dialogText"></div>
          <div class="hint">
            <div id="subHint">â€¦</div>
            <div class="caret" id="caret">â–¼</div>
          </div>
        </div>

        <!-- é¸å–® -->
        <div class="menu box">
          <div class="menuGrid" id="menuGrid"></div>
        </div>
      </div>

      <div class="box" style="margin-top:10px; display:flex; justify-content:space-between; align-items:center; gap:10px;">
        <div style="font-size:10px;">é€šé—œå¾Œæœƒè§£é– ğŸ</div>
        <a class="linkBtn" id="giftBtn" href="#" target="_blank" rel="noopener" style="display:none;">æ‰“é–‹ç¦®ç‰©å½±ç‰‡</a>
      </div>
    </div>
  </div>

<script>
  // ä½ åªè¦æ”¹é€™å…©è¡Œ
  const BOYFRIEND_NAME = "BOYFRIEND_NAME";
  const GIFT_VIDEO_URL = "GIFT_VIDEO_URL";

  // åŸºæœ¬ç‹€æ…‹
  const state = {
    stage: 0,
    busy: false,
    oppHp: 20, oppMax: 20,
    meHp: 20,  meMax: 20,
  };

  // ä¸‰å€‹é—œå¡ï¼ˆç”Ÿå­˜æŒ‡å—é¡Œç›®ï¼‰åšæˆã€Œæ‹›å¼ã€
  const stages = [
    {
      intro: () => `é‡ç”Ÿçš„ ${BOYFRIEND_NAME} å‡ºç¾äº†ï¼\n${BOYFRIEND_NAME} ä½¿å‡ºäº†ã€Œå˜´ç¡¬ï¼šæˆ‘æ²’äº‹ã€ã€‚`,
      prompt: () => "ä½ è¦æ€éº¼æ‡‰å°ï¼Ÿ",
      moves: [
        { name: "æŠ±æŠ±æ¨¡å¼", dmg: 6, msg: "ä½ ä½¿ç”¨äº†ã€ŒæŠ±æŠ±ã€ï¼å°æ–¹æƒ…ç·’ç©©å®šä¸Šå‡ï¼", good: true },
        { name: "é¤µé£Ÿæ¨¡å¼", dmg: 6, msg: "ä½ ä¸Ÿå‡ºäº†ã€Œé£Ÿç‰©ã€ï¼æœ‰æ•ˆï¼", good: true },
        { name: "é€¼å•æ¨¡å¼", dmg: 2, msg: "ä½ ä½¿ç”¨äº†ã€Œé€¼å•ã€â€¦æ•ˆæœæ™®é€šã€‚", good: false },
        { name: "æ”¾ç©ºç­‰å¾…", dmg: 3, msg: "ä½ é¸æ“‡å…ˆé™ªè‘—ä¸é€¼ä»–â€¦æ…¢æ…¢æœ‰æ•ˆã€‚", good: true },
      ],
      counter: () => ({ dmg: 3, msg: `${BOYFRIEND_NAME} ä½¿å‡ºã€Œæˆ‘çœŸçš„æ²’äº‹ã€ï¼ä½ æœ‰é»è‘—æ€¥â€¦` })
    },
    {
      intro: () => `${BOYFRIEND_NAME} çš„ HP é‚„åœ¨ï¼\n${BOYFRIEND_NAME} è§¸ç™¼äº‹ä»¶ï¼šã€Œæˆ‘ä¸é¤“ã€ã€‚`,
      prompt: () => "ä½ çš„æ“ä½œæ˜¯ï¼Ÿ",
      moves: [
        { name: "å…ˆè²·å†èªª", dmg: 7, msg: "ä½ ä½¿å‡ºã€Œå…ˆè²·å†èªªã€ï¼å‚³èªªç´šæ­£è§£ã€‚", good: true },
        { name: "å®Œå…¨ç›¸ä¿¡", dmg: 2, msg: "ä½ ç›¸ä¿¡äº†â€¦é¢¨éšªå¾ˆé«˜ã€‚", good: false },
        { name: "åˆ†ä¸€å£è©¦è©¦", dmg: 5, msg: "ä½ éå‡ºä¸€å£â€¦å°æ–¹é–‹å§‹å‹•æ–ã€‚", good: true },
        { name: "è£å¯æ†", dmg: 4, msg: "ä½ ä½¿å‡ºã€Œè£å¯æ†ã€â€¦æœ‰æ•ˆä½†æœ‰é»å®³ç¾ã€‚", good: true },
      ],
      counter: () => ({ dmg: 4, msg: `${BOYFRIEND_NAME} ä½¿å‡ºã€Œé¤“åˆ°æ²’è€å¿ƒã€ï¼ä½ çš„ HP ä¸‹é™ã€‚` })
    },
    {
      intro: () => `æœ€çµ‚é—œï¼${BOYFRIEND_NAME} é€²å…¥ã€Œç´¯äº†æƒ³éœä¸€éœã€ç‹€æ…‹ã€‚`,
      prompt: () => "è«‹é¸æ“‡æœ€çµ‚æŒ‡ä»¤ï¼š",
      moves: [
        { name: "å…ˆåœä¸€ä¸‹å†è¬›", dmg: 8, msg: "ä½ ä½¿ç”¨äº†ã€Œæˆ‘åœ¨ï¼Œç­‰ä½ æº–å‚™å¥½ã€ï¼æ•ˆæœæ‹”ç¾¤ã€‚", good: true },
        { name: "ä¸€å¥é‡é»", dmg: 6, msg: "ä½ ç”¨ä¸€å¥è©±è¬›æ¸…æ¥šâ€¦æœ‰æ•ˆï¼", good: true },
        { name: "è¬›å¤§é“ç†", dmg: 1, msg: "ä½ é–‹å§‹é•·ç¯‡åˆ†æâ€¦æ•ˆæœå¾ˆå·®ã€‚", good: false },
        { name: "æŠ±ä¸€ä¸‹å°±å¥½", dmg: 7, msg: "ä½ æŠ±äº†ä¸€ä¸‹ã€‚ä¸–ç•Œå®‰éœäº†ã€‚", good: true },
      ],
      counter: () => ({ dmg: 5, msg: `${BOYFRIEND_NAME} ä½¿å‡ºã€Œæˆ‘æƒ³èº²èµ·ä¾†ã€â€¦ä½ æœ‰é»å¿ƒç–¼ã€‚` })
    }
  ];

  const $ = id => document.getElementById(id);

  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  function renderBars(){
    $("oppHpText").textContent = state.oppHp;
    $("meHpText").textContent = state.meHp;
    $("oppHpFill").style.width = (state.oppHp/state.oppMax*100) + "%";
    $("meHpFill").style.width  = (state.meHp/state.meMax*100) + "%";
  }

  function setNames(){
    $("oppName").textContent = BOYFRIEND_NAME;
    $("giftBtn").href = GIFT_VIDEO_URL;
  }

  // æ‰“å­—æ•ˆæœ
  async function typeText(text){
    state.busy = true;
    $("caret").style.visibility = "hidden";
    $("dialogText").textContent = "";
    for (let i=0;i<text.length;i++){
      $("dialogText").textContent += text[i];
      await new Promise(r => setTimeout(r, text[i]==="\n" ? 140 : 18));
    }
    $("caret").style.visibility = "visible";
    state.busy = false;
  }

  function setSubHint(t){ $("subHint").textContent = t; }

  function setMenu(options){
    const grid = $("menuGrid");
    grid.innerHTML = "";
    options.forEach((opt) => {
      const b = document.createElement("button");
      b.className = "btn";
      b.innerHTML = `<span>${opt.label}</span>`;
      b.disabled = !!opt.disabled;
      b.onclick = opt.onClick;
      grid.appendChild(b);
    });
  }

  async function startStage(){
    renderBars();
    const s = stages[state.stage];
    setMenu([
      { label:"FIGHT", onClick: openFight },
      { label:"BAG",   onClick: () => fakeBag() },
      { label:"RUN",   onClick: () => fakeRun() },
      { label:"INFO",  onClick: () => showInfo() }
    ]);
    await typeText(s.intro());
    setSubHint("é¸æ“‡æŒ‡ä»¤");
  }

  function openFight(){
    if (state.busy) return;
    const s = stages[state.stage];
    setMenu(s.moves.map((m, idx) => ({
      label: m.name,
      onClick: () => useMove(idx)
    })));
    setSubHint(s.prompt());
  }

  async function useMove(idx){
    if (state.busy) return;
    const s = stages[state.stage];
    const m = s.moves[idx];

    // ç©å®¶å‡ºæ‹›
    await typeText(m.msg);
    state.oppHp = clamp(state.oppHp - m.dmg, 0, state.oppMax);
    renderBars();

    // åˆ¤å®šæ˜¯å¦éé—œ
    if (state.oppHp <= 0){
      await winBattle();
      return;
    }

    // å°æ‰‹åæ“Šï¼ˆå°æ‰£è¡€ï¼Œè®“å®ƒåƒå°æˆ°ï¼‰
    const c = s.counter();
    await typeText(c.msg);
    state.meHp = clamp(state.meHp - c.dmg, 0, state.meMax);
    renderBars();

    if (state.meHp <= 0){
      await loseBattle();
      return;
    }

    // å›åˆ°ä¸»é¸å–®
    setMenu([
      { label:"FIGHT", onClick: openFight },
      { label:"BAG",   onClick: () => fakeBag() },
      { label:"RUN",   onClick: () => fakeRun() },
      { label:"INFO",  onClick: () => showInfo() }
    ]);
    setSubHint("è¼ªåˆ°ä½ äº†");
  }

  async function winBattle(){
    // æ¯é—œæŠŠ HP è£œå›ä¸€é»ï¼Œåƒéé—œ
    await typeText(`ä½ æ“Šç ´äº†æœ¬é—œäº‹ä»¶ï¼\nï¼ˆä½ å€‘çš„é»˜å¥‘ +1ï¼‰`);
    state.meHp = clamp(state.meHp + 6, 0, state.meMax);
    state.oppHp = state.oppMax; // é‡ç½®çµ¦ä¸‹ä¸€é—œ
    renderBars();

    state.stage += 1;

    if (state.stage >= stages.length){
      // å…¨ç ´
      await typeText(`ğŸ‰ Achievement Unlockedï¼šäº¤å¾€ä¸€å¹´\nç”Ÿæ—¥å¿«æ¨‚ï¼Œ${BOYFRIEND_NAME}ã€‚\næˆ‘çš„æœ€çµ‚æŒ‡ä»¤æ°¸é æ˜¯ï¼šé¸ä½ ã€‚`);
      setSubHint("è§£é–ç¦®ç‰©ï¼");
      $("giftBtn").style.display = "inline-block";
      setMenu([
        { label:"æ‰“é–‹ç¦®ç‰©", onClick: () => $("giftBtn").click() },
        { label:"å†ç©ä¸€æ¬¡", onClick: resetAll },
        { label:"çœ‹ç¥ç¦",   onClick: () => typeText(`ç”Ÿæ—¥å¿«æ¨‚ï¼Œ${BOYFRIEND_NAME}ã€‚\nè¬è¬ä½ é€™ä¸€å¹´ã€‚\nä¸‹ä¸€é—œä¹Ÿæƒ³ç¹¼çºŒè·Ÿä½ çµ„éšŠã€‚`) },
        { label:"END",     disabled:true, onClick: () => {} },
      ]);
      return;
    }

    // ä¸‹ä¸€é—œé–‹å§‹
    await startStage();
  }

  async function loseBattle(){
    await typeText(`ä½ å€’ä¸‹äº†â€¦ä½†æ²’é—œä¿‚ã€‚\né‡æ–°æ•´ç†ä¸€ä¸‹ï¼Œç¹¼çºŒé€šé—œï¼`);
    setSubHint("å†è©¦ä¸€æ¬¡");
    setMenu([
      { label:"CONTINUE", onClick: resetStage },
      { label:"RESTART",  onClick: resetAll },
      { label:"BAG",      onClick: () => fakeBag() },
      { label:"RUN",      onClick: () => fakeRun() },
    ]);
  }

  async function fakeBag(){
    if (state.busy) return;
    await typeText("ä½ æ‰“é–‹äº† BAGâ€¦\nç²å¾—é“å…·ï¼šã€é›¶é£Ÿã€Ã—1ã€ ã€æŠ±æŠ±ã€Ã—âˆ");
    setSubHint("é¸æ“‡æŒ‡ä»¤");
  }

  async function fakeRun(){
    if (state.busy) return;
    await typeText("ä½ å˜—è©¦é€ƒè·‘â€¦\nä½†æ˜¯ä½ æ¨ä¸å¾—ã€‚");
    setSubHint("é¸æ“‡æŒ‡ä»¤");
  }

  async function showInfo(){
    if (state.busy) return;
    await typeText(`å°æ‰‹ï¼š${BOYFRIEND_NAME}\nå±¬æ€§ï¼šå˜´ç¡¬ï¼æº«æŸ”ï¼å¯æ„›\nå¼±é»ï¼šä½  + é£Ÿç‰© + æ“æŠ±`);
    setSubHint("é¸æ“‡æŒ‡ä»¤");
  }

  function resetStage(){
    state.busy = false;
    state.meHp = state.meMax;
    state.oppHp = state.oppMax;
    renderBars();
    startStage();
  }

  function resetAll(){
    state.stage = 0;
    state.meHp = state.meMax;
    state.oppHp = state.oppMax;
    $("giftBtn").style.display = "none";
    startStage();
  }

  // init
  setNames();
  renderBars();
  startStage();
</script>
</body>
</html>
